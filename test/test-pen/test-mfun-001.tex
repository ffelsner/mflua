\starttext
\switchtobodyfont[ss,3.2pt]
\startMPpage
z0=(0,0); z1=(50,0);
pickup pensquare xscaled 5 yscaled 10 rotated 45;
drawoptions(withcolor 0.95*white);
%pickup pencircle scaled 5 ;
draw z0 .. controls (12.5,50) and (37.5,50) .. z1 ;%-- z2 -- z3 -- cycle;


pair wz, woff;
wz:=(0,0);

path p;

pair w[];
w0:=(5.30331,-1.76776);
w1:=(-1.76776,5.30331);
w2:=(-5.30331,1.76776);
w3:=(1.76776,-5.30331);
w4:=w0;

pickup pencircle scaled 0.5pt;drawoptions(withcolor red);
drawdot(w0);drawdot(w1);drawdot(w2);drawdot(w3);
label("w0",w0);label("w1",w1);label("w2",w2);label("w3",w3);
drawoptions(withcolor blue withpen pencircle scaled 0.1pt);
draw w0 -- w1 -- w2 -- w3 -- cycle ;


%%POST print pen
%%
%% octant       ENE-1   1       4396
%% 1/2 w=(1.76776,-5.30331) ww=(1.76776,-5.30331)
%% 2/2 w=(1.76776,-5.30331) ww=(5.30331,-1.76776)
% (5.30331,-1.76776)
%% octant       NNE-2   0       4387
%% 1/1 w=(5.30331,-1.76776) ww=(5.30331,-1.76776)
%% octant       NNW-3   0       4381
%% 1/1 w=(5.30331,-1.76776) ww=(5.30331,-1.76776)
%% octant       WNW-4   1       4372
%% 1/2 w=(5.30331,-1.76776) ww=(-1.76776,5.30331)
% .. 
% (-1.76776,5.30331)
%% 2/2 w=(-1.76776,5.30331) ww=(-1.76776,5.30331)
%% octant       WSW-5   1       4366
%% 1/2 w=(-1.76776,5.30331) ww=(-1.76776,5.30331)
%% 2/2 w=(-1.76776,5.30331) ww=(-5.30331,1.76776)
% .. 
% (-5.30331,1.76776)
%% octant       SSW-6   0       4357
%% 1/1 w=(-5.30331,1.76776) ww=(-5.30331,1.76776)
%% octant       SSE-7   0       4351
%% 1/1 w=(-5.30331,1.76776) ww=(-5.30331,1.76776)
%% octant       ESE-8   1       4342
%% 1/2 w=(-5.30331,1.76776) ww=(1.76776,-5.30331)
% .. 
% (1.76776,-5.30331)
%% 2/2 w=(1.76776,-5.30331) ww=(1.76776,-5.30331)
% .. cycle



%%@ Octant NNE (0 offsets), from (5.30331,-1.76776) to (20.41336,30.84229)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (5.30331,-1.76776) --  (20.41336,30.84229);
%%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (0,0)
 .. controls (4.02275,15.96204) and (9.335,26.835) ..(15.11005,32.61005) ;
draw p;
draw p shifted w0;



%% @ Octant ENE (1 offset), from (20.41336,30.84229) to (26.76776,32.19669)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw  (20.41336,30.84229) --  (26.76776,32.19669);
%% @ retrograde line from (20.41336,30.84229) to (16.8778,27.30673)
drawoptions(withcolor red withpen pencircle scaled 0.1pt);
draw (20.41336,30.84229) -- (16.8778,27.30673);
%%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (15.11005,32.61005)
%Octant ENE-1
%  left_type(p)=0 right_type(p)=1 octant=ENE-1
 .. controls (18.37,35.87) and (21.71368,37.5) ..(25,37.5) % segment 0 left_type(q)=1 right_type(q)=0
;
draw p;
draw p shifted w3;


%@ Octant ESE (1 offset), from (26.76776,32.19669) to (29.83664,34.6278)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (26.76776,32.19669) -- (29.83664,34.6278) ;
%@ retrograde line from (26.76776,32.19669) to (19.69669,39.26776)
drawoptions(withcolor red withpen pencircle scaled 0.1pt);
draw (26.76776,32.19669) -- (19.69669,39.26776);
%%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:= (25,37.5)
%Octant ESE-8
%  left_type(p)=0 right_type(p)=1 octant=ESE-8
 .. controls (28.61494,37.5) and (32.04665,35.95335) ..(35.13995,32.86005) % segment 0 left_type(q)=1 right_type(q)=0
% entering octant `
;
draw p;
draw p shifted w3;


%@ Octant SSE (0 offsets), from (29.83664,34.6278) to (44.69669,1.76776)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (29.83664,34.6278) -- (44.69669,1.76776);
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (35.13995,32.86005)
%Octant SSE-7
%  left_type(p)=0 right_type(p)=1 octant=SSE-7
 .. controls (40.81944,27.18056) and (46.04381,16.2366) ..(50,0) % segment 0 left_type(q)=1 right_type(q)=0
% entering octant `
;
draw p;
draw p shifted w2;



%@ Octant ESE (1 offset), from (44.69669,1.76776) to (51.76776,-5.30331)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (44.69669,1.76776) -- (51.76776,-5.30331);
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (50,-0);
draw p ;
draw p shifted w3;


%@ Octant ENE (1 offset), from (51.76776,-5.30331) to (55.30331,-1.76776)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (51.76776,-5.30331) -- (55.30331,-1.76776) ;
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (50,0);
draw p;
draw p shifted w3;


%@ Octant NNE (0 offsets), from (55.30331,-1.76776) to (55.30331,-1.76776)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (55.30331,-1.76776) -- (55.30331,-1.76776);
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (50,0);
draw p;
draw p shifted w0;



%@ Octant NNW (0 offsets), from (55.30331,-1.76776) to (40.44327,31.09229)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (55.30331,-1.76776) -- (40.44327,31.09229);
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (50,0)
 .. controls (46.04381,16.2366) and (40.81944,27.18056) ..(35.13995,32.86005) % segment 1 left_type(q)=2 right_type(q)=0
;
draw p;
draw p shifted w0;


%@ Octant WNW (1 offset), from (40.44327,31.09229) to (23.23224,42.80331)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (40.44327,31.09229) -- (23.23224,42.80331);
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (35.13995,32.86005)
%Octant WNW-4
%  left_type(p)=0 right_type(p)=1 octant=WNW-4
 .. controls (32.04666,35.95334) and (28.61494,37.5) ..(25,37.5) % segment 1 left_typ
;
draw p;
draw p shifted w1;


%@ Octant WSW (1 offset), from (23.23224,42.80331) to (9.80673,34.3778)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (23.23224,42.80331) -- (9.80673,34.3778);
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (25,37.5)
 .. controls (21.71368,37.5) and (18.37001,35.87001) ..(15.11005,32.61005) % segment 
;
draw p;
draw p shifted w1;


%@ Octant SSW (0 offsets), from (9.80673,34.3778) to (-5.30331,1.76776)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (9.80673,34.3778) -- (-5.30331,1.76776) ;
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=   (15.11005,32.61005)
%Octant SSW-6
%  left_type(p)=0 right_type(p)=1 octant=SSW-6
 .. controls (9.335,26.835) and (4.02275,15.96204) ..(-0,-0) % segment 1 left_type(q)
;
draw p;
draw p shifted w2;


%@ Octant SSE (0 offsets), from (-5.30331,1.76776) to (-5.30331,1.76776)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (-5.30331,1.76776) -- (-5.30331,1.76776) ;
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (0,-0);
draw p ;
draw p shifted w2;


%@ Octant ENE (1 offset), from (1.76776,-5.30331) to (5.30331,-1.76776)
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw (1.76776,-5.30331) -- (5.30331,-1.76776) ;
%POST print specification
drawoptions(withcolor black withpen pencircle scaled 0.1pt);
p:=    (0,0);
draw p;
draw p shifted w3;



\stopMPpage
\stoptext


\starttext
\switchtobodyfont[ss,3.2pt]
\startMPpage
z0=(0,0); z1=(50,0);
pickup pensquare xscaled 5 yscaled 10 rotated 45;
drawoptions(withcolor 0.95);
%pickup pencircle scaled 5 ;
draw z0 .. controls (12.5,50) and (37.5,50) .. z1 ;%-- z2 -- z3 -- cycle;

%% Pen polygon at line 4 (newly created):
%% (5.30331,-1.76776)
%%  .. (-1.76776,5.30331)
%%  .. (-5.30331,1.76776)
%%  .. (1.76776,-5.30331)
%%  .. cycle


%% POST print pen

%% octant  ENE-1   1       4396
%% (5.30331,-1.76776)
%% octant  NNE-2   0       4387
%% 1       4387
%% 2       4384
%% octant  NNW-3   0       4381
%% octant  WNW-4   1       4372
%% 1       4372
%% 2       4375
%%  .. 
%% (-1.76776,5.30331)
%% octant  WSW-5   1       4366
%%  .. 
%% (-5.30331,1.76776)
%% octant  SSW-6   0       4357
%% 1       4357
%% 2       4354
%% octant  SSE-7   0       4351
%% octant  ESE-8   1       4342
%% 1       4342
%% 2       4345
%%  .. 
%% (1.76776,-5.30331)
%%  .. cycle




z2=(5.30331,-1.76776);
z3=(-1.76776,5.30331);
z4=(-5.30331,1.76776);
z5=(1.76776,-5.30331);


pickup pencircle scaled 0.15pt;drawoptions(withcolor green);
draw (5.30331,-1.76776) -- (20.41336,30.84229);

pickup pencircle scaled 0.5pt;drawoptions(withcolor red);
drawdot(z2);drawdot(z3);drawdot(z4);drawdot(z5);
label("z2",z2);label("z3",z3);label("z4",z4);label("z5",z5);

drawoptions(withcolor blue withpen pencircle scaled 0.1pt);
draw (5.30331,-1.76776)
 -- (-1.76776,5.30331)
 -- (-5.30331,1.76776)
 -- (1.76776,-5.30331)
 -- cycle;


pair w, oldw;
w:=z4;

drawoptions(withcolor blue withpen pencircle scaled 0.1pt);
draw 	((0,0)+w)
%Octant	NNE-2
%  left_type(p)=0 right_type(p)=1
 .. controls ((4.02275,15.96204)+w) and ((9.335,26.835)+w) ..((15.11005,32.61005)+w); % segment 0 left_type(q)=1 right_type(q)=0

w:=z2;
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw 	((0,0)+w)
%Octant	NNE-2
%  left_type(p)=0 right_type(p)=1
 .. controls ((4.02275,15.96204)+w) and ((9.335,26.835)+w) ..((15.11005,32.61005)+w); % segment 0 left_type(q)=1 right_type(q)=0



pickup pencircle scaled 0.2;drawoptions(withcolor red);
drawdot( (15.11005,32.61005)+w);
label("(15.11005,32.61005)+z4",  (15.11005,32.61005)+w);



oldw:=w;
w:=z3;
drawoptions(withcolor green withpen pencircle scaled 0.1pt);
draw ((15.11005,32.61005)+oldw) -- ((15.11005,32.61005)+w);

pickup pencircle scaled 1;drawoptions(withcolor red);
drawdot( (15.11005,32.61005)+w);
label("(15.11005,32.61005)+z3",  (15.11005,32.61005)+w);



drawoptions(withcolor blue withpen pencircle scaled 0.1pt);
draw ((15.11005,32.61005)+w)
     .. controls ((18.37,35.87)+w) and ((21.71368,37.5)+w) ..((25,37.5)+w);




drawoptions(withcolor white withpen pencircle scaled 0.1pt);
draw 	(0,0)
%Octant	NNE-2
%  left_type(p)=0 right_type(p)=1
 .. controls (4.02275,15.96204) and (9.335,26.835) ..(15.11005,32.61005) % segment 0 left_type(q)=1 right_type(q)=0
% entering octant `
%Octant	ENE-1
%  left_type(p)=0 right_type(p)=1
 .. controls (18.37,35.87) and (21.71368,37.5) ..(25,37.5) % segment 0 left_type(q)=1 right_type(q)=0
% entering octant `
%Octant	ESE-8
%  left_type(p)=0 right_type(p)=3
 .. controls (28.61494,37.5) and (32.04665,35.95335) ..(35.13995,32.86005) % segment 0 left_type(q)=1 right_type(q)=0
% entering octant `
%Octant	SSE-7
%  left_type(p)=0 right_type(p)=7
 .. controls (40.81944,27.18056) and (46.04381,16.2366) ..(50,0) % segment 0 left_type(q)=1 right_type(q)=0
% entering octant `
%Octant	ESE-8
%  left_type(p)=0 right_type(p)=0
% entering octant `
%Octant	ENE-1
%  left_type(p)=0 right_type(p)=0
% entering octant `
%Octant	NNE-2
%  left_type(p)=0 right_type(p)=0
% entering octant `
%Octant	NNW-3
%  left_type(p)=0 right_type(p)=6
 .. controls (46.04381,16.2366) and (40.81944,27.18056) ..(35.13995,32.86005) % segment 1 left_type(q)=2 right_type(q)=0
% entering octant `
%Octant	WNW-4
%  left_type(p)=0 right_type(p)=2
 .. controls (32.04666,35.95334) and (28.61494,37.5) ..(25,37.5) % segment 1 left_type(q)=2 right_type(q)=0
% entering octant `
%Octant	WSW-5
%  left_type(p)=0 right_type(p)=4
 .. controls (21.71368,37.5) and (18.37001,35.87001) ..(15.11005,32.61005) % segment 1 left_type(q)=2 right_type(q)=0
% entering octant `
%Octant	SSW-6
%  left_type(p)=0 right_type(p)=8
 .. controls (9.335,26.835) and (4.02275,15.96204) ..(-0,-0) % segment 1 left_type(q)=2 right_type(q)=0
% entering octant `
%Octant	SSE-7
%  left_type(p)=0 right_type(p)=0
% entering octant `
%Octant	ESE-8
%  left_type(p)=0 right_type(p)=0
% entering octant `
%Octant	ENE-1
%  left_type(p)=0 right_type(p)=0
;% & cycle


\stopMPpage
\stoptext

